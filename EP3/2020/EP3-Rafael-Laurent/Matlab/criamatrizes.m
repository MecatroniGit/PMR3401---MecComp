function [K,M,Malternas] = criamatrizes
%Função para criar as
%Matrizes de rigidez e de massa por elemento
%Matrizes ordenadas por [u1 w1 phi1 u2 w2 phi2]

global ro E 

%Matriz de rigidez por elemento
Coord1=@(L,A) E*A/L;
Coord2=@(L,I) E*I/L^3;
Coord3=@(L,I) E*I/L^2;
Coord4=@(L,I) E*I/L;
K=@(L,A,I) ...
[Coord1(L,A) 0 0 -Coord1(L,A) 0 0; ...
0 12*Coord2(L,I) 6*Coord3(L,I) 0 -12*Coord2(L,I) 6*Coord3(L,I);...
0 6*Coord3(L,I) 4*Coord4(L,I) 0 -6*Coord3(L,I) 2*Coord4(L,I);...
-Coord1(L,A) 0 0 Coord1(L,A) 0 0; ...
0 -12*Coord2(L,I) -6*Coord3(L,I) 0 12*Coord2(L,I) -6*Coord3(L,I);...
0 6*Coord3(L,I) 2*Coord4(L,I) 0 -6*Coord3(L,I) 4*Coord4(L,I)];

%Matriz de massa por elemento
Coord5=@(L,A) ro*A*L/420;
Coord6=@(L,A) ro*A*L^2/420;
Coord7=@(L,A) ro*A*L^3/420;
M=@(L,A) [140*Coord5(L,A) 0 0 70*Coord5(L,A) 0 0; ...
0 156*Coord5(L,A) 22*Coord6(L,A) 0 54*Coord5(L,A) -13*Coord6(L,A);...
0 22*Coord6(L,A) 4*Coord7(L,A) 0 13*Coord6(L,A) -3*Coord7(L,A);...
70*Coord5(L,A) 0 0 140*Coord5(L,A) 0 0;...
0 54*Coord5(L,A) 13*Coord6(L,A) 0 156*Coord5(L,A) -22*Coord6(L,A);...
0 -13*Coord6(L,A) -3*Coord7(L,A) 0 -22*Coord6(L,A) 4*Coord7(L,A)];

%Matriz de massa 'lumped' por elemento
Coord8=@(L,A) ro*A*L/78;
Coord9=@(L,A) ro*A*L^3/78;
Malternas=@(L,A)[39*Coord8(L,A) 0 0 0 0 0; 0 39*Coord8(L,A) 0 0 0 0;...
0 0 Coord9(L,A) 0 0 0; 0 0 0 39*Coord8(L,A) 0 0; ...
0 0 0 0 39*Coord8(L,A) 0; 0 0 0 0 0 Coord9(L,A)];
end

